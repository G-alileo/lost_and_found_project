<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Dashboard - CampusFound</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="../css/custom-styles.css">
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: {
              DEFAULT: '#1D4ED8',
              hover: '#0A47A3',
              light: '#3B82F6'
            },
            secondary: '#64748b',
            accent: {
              DEFAULT: '#06B6D4',
              hover: '#0EA5E9'
            },
            surface: {
              DEFAULT: '#FFFFFF',
              alt: '#E0F2FE'
            },
            background: {
              DEFAULT: '#F8FAFC',
              alt: '#EFF6FF'
            }
          },
          animation: {
            'fade-in': 'fadeIn 0.5s ease-in-out',
            'slide-up': 'slideUp 0.6s ease-out',
            'slide-in-right': 'slideInRight 0.5s ease-out',
            'bounce-gentle': 'bounceGentle 2s ease-in-out infinite',
            'pulse-soft': 'pulseSoft 2s ease-in-out infinite',
            'float': 'float 6s ease-in-out infinite',
            'dock-slide-up': 'dockSlideUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards',
            'dock-bounce': 'dockBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards',
            'dock-glow': 'dockGlow 2s ease-in-out infinite'
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' }
            },
            slideUp: {
              '0%': { opacity: '0', transform: 'translateY(20px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' }
            },
            slideInRight: {
              '0%': { opacity: '0', transform: 'translateX(20px)' },
              '100%': { opacity: '1', transform: 'translateX(0)' }
            },
            bounceGentle: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-5px)' }
            },
            pulseSoft: {
              '0%, 100%': { opacity: '1' },
              '50%': { opacity: '0.7' }
            },
            float: {
              '0%, 100%': { transform: 'translateY(0px) rotate(0deg)' },
              '25%': { transform: 'translateY(-10px) rotate(2deg)' },
              '50%': { transform: 'translateY(-20px) rotate(0deg)' },
              '75%': { transform: 'translateY(-10px) rotate(-2deg)' }
            },
            dockSlideUp: {
              '0%': { 
                opacity: '0', 
                transform: 'translateX(-50%) translateY(100px) scale(0.8)',
                filter: 'blur(10px)'
              },
              '100%': { 
                opacity: '1', 
                transform: 'translateX(-50%) translateY(0) scale(1)',
                filter: 'blur(0px)'
              }
            },
            dockBounce: {
              '0%': { transform: 'scale(1) translateY(0)' },
              '50%': { transform: 'scale(1.05) translateY(-8px)' },
              '100%': { transform: 'scale(1) translateY(0)' }
            },
            dockGlow: {
              '0%, 100%': { 
                boxShadow: '0 8px 32px rgba(29, 78, 216, 0.2), 0 0 0 1px rgba(255, 255, 255, 0.1)' 
              },
              '50%': { 
                boxShadow: '0 12px 48px rgba(29, 78, 216, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.2)' 
              }
            }
          }
        }
      }
    }
  </script>
  <style>
    .glass-effect {
      background: rgba(31, 41, 55, 0.8);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(75, 85, 99, 0.3);
    }
    
    .hover-lift {
      transition: all 0.3s ease;
    }
    
    .hover-lift:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .gradient-border {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 1px;
      border-radius: 12px;
    }
    
    .gradient-border-content {
      background: #1f2937;
      border-radius: 11px;
      padding: 1.5rem;
    }
    
    .stats-card {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(147, 51, 234, 0.1) 100%);
      border: 1px solid rgba(59, 130, 246, 0.2);
    }
    
    .empty-state {
      background: radial-gradient(circle at center, rgba(59, 130, 246, 0.05) 0%, transparent 70%);
    }

    .badge-lost {
      background-color: rgba(239, 68, 68, 0.2);
      color: #fca5a5;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
    }

    .badge-found {
      background-color: rgba(34, 197, 94, 0.2);
      color: #86efac;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
    }

    .badge-pending {
      background-color: rgba(251, 191, 36, 0.2);
      color: #fde047;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
    }

    .badge-confirmed {
      background-color: rgba(34, 197, 94, 0.2);
      color: #86efac;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
    }

    .badge-rejected {
      background-color: rgba(107, 114, 128, 0.2);
      color: #d1d5db;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
    }
  </style>
</head>
<body class="min-h-screen bg-background dark:bg-gray-900 transition-colors duration-300 flex flex-col">
  <!-- Simplified Header with Logo Only -->
  <header class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-md border-b border-gray-200/50 dark:border-gray-700/50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-center items-center h-16">
        <!-- Logo -->
        <div class="flex items-center">
          <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center mr-3">
            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <a href="./index.html" class="text-xl font-bold text-gray-900 dark:text-white">LOAF</a>
        </div>

            <!-- Dropdown Menu -->
            <div id="userDropdown" class="hidden absolute right-0 mt-2 w-64 bg-gray-800 rounded-lg shadow-lg border border-gray-700 z-50">
              <div class="py-2">
                <!-- User Info Section -->
                <div class="px-4 py-3 border-b border-gray-700">
                  <div class="flex items-center space-x-3">
                    <div id="dropdownAvatarContainer" class="w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center">
                      <img id="dropdownAvatar" class="w-10 h-10 rounded-full hidden" src="" alt="">
                      <svg id="dropdownDefaultAvatar" class="w-6 h-6 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                      </svg>
                    </div>
                    <div>
                      <p id="dropdownUserName" class="text-sm font-medium text-white"></p>
                      <p id="dropdownUserEmail" class="text-xs text-gray-400"></p>
                    </div>
                  </div>
                </div>

                <!-- Menu Items -->
                <div class="py-1">
                  <button id="editProfileBtn" class="flex items-center w-full px-4 py-2 text-sm text-gray-200 hover:bg-gray-700 transition-colors duration-200">
                    <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    Edit Profile
                  </button>
                  
                  <button id="changePasswordBtn" class="flex items-center w-full px-4 py-2 text-sm text-gray-200 hover:bg-gray-700 transition-colors duration-200">
                    <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                    </svg>
                    Change Password
                  </button>

                  <a href="./index.html" class="flex items-center w-full px-4 py-2 text-sm text-gray-200 hover:bg-gray-700 transition-colors duration-200">
                    <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                    </svg>
                    Home
                  </a>

                  <div class="border-t border-gray-700 my-1"></div>

                  <button id="logoutBtn" class="flex items-center w-full px-4 py-2 text-sm text-red-400 hover:bg-red-900/20 transition-colors duration-200">
                    <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                    </svg>
                    Sign Out
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Background Elements -->
  <div class="fixed inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-20 left-10 w-64 h-64 bg-blue-500/5 rounded-full animate-float"></div>
    <div class="absolute top-40 right-20 w-32 h-32 bg-purple-500/5 rounded-full animate-float" style="animation-delay: 2s;"></div>
    <div class="absolute bottom-20 left-1/4 w-48 h-48 bg-green-500/5 rounded-full animate-float" style="animation-delay: 4s;"></div>
  </div>

  <!-- Main Content -->
  <main class="flex-grow relative z-10 w-full px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-16 py-8 min-h-[calc(100vh-theme(spacing.16)-theme(spacing.32))]">
    <!-- Page Header -->
    <div class="mb-12 animate-fade-in">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-4xl font-bold text-white mb-3 bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent">
            My Dashboard
          </h1>
          <p class="text-gray-600 dark:text-gray-400 text-lg">Manage your reports, matches, and notifications</p>
        </div>
        <div class="flex space-x-4">
          <div class="relative">
            <button id="reportItemBtn" class="px-6 py-3 bg-gradient-to-r from-primary to-accent hover:from-primary-hover hover:to-accent-hover text-white rounded-xl font-medium transition-all duration-300 hover:shadow-lg hover:shadow-primary/25 hover:scale-105">
              <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
              </svg>
              Report Item
            </button>
            <!-- Dropdown Menu -->
            <div id="reportDropdown" class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 z-50">
              <div class="py-2">
                <a href="./report-lost.html" class="flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-primary/10 dark:hover:bg-primary/20 transition-colors duration-200">
                  <svg class="w-4 h-4 mr-3 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                  </svg>
                  Report Lost Item
                </a>
                <a href="./report-found.html" class="flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-primary/10 dark:hover:bg-primary/20 transition-colors duration-200">
                  <svg class="w-4 h-4 mr-3 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  Report Found Item
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 2xl:grid-cols-4 gap-6 mb-12">
      <div class="stats-card rounded-xl p-6 hover-lift animate-slide-up">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-600 dark:text-gray-400 text-sm font-medium">Total Reports</p>
            <p class="text-3xl font-bold text-gray-900 dark:text-white mt-1" id="totalReports">0</p>
          </div>
          <div class="w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center">
            <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
          </div>
        </div>
      </div>

      <div class="stats-card rounded-xl p-6 hover-lift animate-slide-up" style="animation-delay: 0.1s;">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-600 dark:text-gray-400 text-sm font-medium">Active Matches</p>
            <p class="text-3xl font-bold text-gray-900 dark:text-white mt-1" id="activeMatches">0</p>
          </div>
          <div class="w-12 h-12 bg-accent/20 rounded-lg flex items-center justify-center">
            <svg class="w-6 h-6 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
        </div>
      </div>

      <div class="stats-card rounded-xl p-6 hover-lift animate-slide-up" style="animation-delay: 0.2s;">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-600 dark:text-gray-400 text-sm font-medium">Resolved Items</p>
            <p class="text-3xl font-bold text-gray-900 dark:text-white mt-1" id="resolvedItems">0</p>
          </div>
          <div class="w-12 h-12 bg-primary-light/20 rounded-lg flex items-center justify-center">
            <svg class="w-6 h-6 text-primary-light" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
        </div>
      </div>

      <div class="stats-card rounded-xl p-6 hover-lift animate-slide-up" style="animation-delay: 0.3s;">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-gray-600 dark:text-gray-400 text-sm font-medium">Notifications</p>
            <p class="text-3xl font-bold text-gray-900 dark:text-white mt-1" id="notificationCount">0</p>
          </div>
          <div class="w-12 h-12 bg-accent-hover/20 rounded-lg flex items-center justify-center">
            <svg class="w-6 h-6 text-accent-hover" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM4 19h5v-5l-5 5z"></path>
            </svg>
          </div>
        </div>
      </div>
    </div>

    <!-- Enhanced Tab Navigation -->
    <div class="mb-8 animate-slide-up" style="animation-delay: 0.4s;">
      <div class="glass-effect rounded-xl p-2">
        <nav class="flex space-x-2">
          <button
            id="myReportsTab"
            class="tab-button flex-1 py-3 px-6 rounded-lg font-medium transition-all duration-300 bg-gradient-to-r from-primary to-accent text-white shadow-lg"
            onclick="switchTab('myReports')"
          >
            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            My Reports
          </button>
          <button
            id="matchesTab"
            class="tab-button flex-1 py-3 px-6 rounded-lg font-medium transition-all duration-300 text-gray-400 hover:text-white hover:bg-gray-700/50"
            onclick="switchTab('matches')"
          >
            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            Matches
          </button>
          <button
            id="notificationsTab"
            class="tab-button flex-1 py-3 px-6 rounded-lg font-medium transition-all duration-300 text-gray-400 hover:text-white hover:bg-gray-700/50 relative"
            onclick="switchTab('notifications')"
          >
            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM4 19h5v-5l-5 5z"></path>
            </svg>
            Notifications
            <span id="notificationBadge" class="hidden absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full">0</span>
          </button>
        </nav>
      </div>
    </div>

    <!-- Enhanced Tab Content -->
    <div id="tabContent" class="animate-slide-up" style="animation-delay: 0.5s;">
      <!-- My Reports Tab -->
      <div id="myReportsContent" class="tab-content">
        <div class="glass-effect rounded-xl overflow-hidden hover-lift">
          <!-- Enhanced Header -->
          <div class="px-8 py-6 border-b border-gray-700/50 bg-gradient-to-r from-blue-600/10 to-purple-600/10">
            <div class="flex items-center justify-between">
              <div>
                <h2 class="text-2xl font-bold text-white mb-2">My Reported Items</h2>
                <p class="text-gray-400">Track and manage your lost/found item reports</p>
              </div>
              <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200">
                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                </svg>
                New Report
              </button>
            </div>
          </div>

          <!-- Enhanced Table -->
          <div class="overflow-x-auto">
            <table class="w-full">
              <thead>
                <tr class="bg-gray-800/50">
                  <th class="px-8 py-4 text-left text-sm font-semibold text-gray-300 uppercase tracking-wider">Item</th>
                  <th class="px-8 py-4 text-left text-sm font-semibold text-gray-300 uppercase tracking-wider">Description</th>
                  <th class="px-8 py-4 text-left text-sm font-semibold text-gray-300 uppercase tracking-wider">Date</th>
                  <th class="px-8 py-4 text-left text-sm font-semibold text-gray-300 uppercase tracking-wider">Status</th>
                  <th class="px-8 py-4 text-left text-sm font-semibold text-gray-300 uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody id="reportsTableBody" class="divide-y divide-gray-700/50">
                <!-- Enhanced Empty State -->
                <tr>
                  <td colspan="5" class="px-8 py-16 text-center">
                    <div class="empty-state rounded-xl p-8 mx-8">
                      <div class="w-24 h-24 bg-gray-700/50 rounded-full flex items-center justify-center mx-auto mb-6 animate-bounce-gentle">
                        <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                      </div>
                      <h3 class="text-xl font-semibold text-white mb-2">No reports yet</h3>
                      <p class="text-gray-400 mb-6">Start by reporting a lost or found item</p>
                      <button class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-medium hover-lift transition-all duration-300">
                        Report Item
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Enhanced Matches Tab -->
      <div id="matchesContent" class="tab-content hidden">
        <div class="glass-effect rounded-xl overflow-hidden hover-lift">
          <div class="px-8 py-6 border-b border-gray-700/50 bg-gradient-to-r from-green-600/10 to-blue-600/10">
            <div class="flex items-center justify-between">
              <div>
                <h2 class="text-2xl font-bold text-white mb-2">Potential Matches</h2>
                <p class="text-gray-400">AI-powered matches for your reported items</p>
              </div>
            </div>
          </div>
          <div id="matchesList" class="p-8">
            <div class="empty-state rounded-xl p-8 text-center">
              <div class="w-24 h-24 bg-gray-700/50 rounded-full flex items-center justify-center mx-auto mb-6 animate-pulse-soft">
                <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
              </div>
              <h3 class="text-xl font-semibold text-white mb-2">No matches found</h3>
              <p class="text-gray-400">We'll notify you when potential matches are discovered</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Enhanced Notifications Tab -->
      <div id="notificationsContent" class="tab-content hidden">
        <div class="glass-effect rounded-xl overflow-hidden hover-lift">
          <div class="px-8 py-6 border-b border-gray-700/50 bg-gradient-to-r from-yellow-600/10 to-orange-600/10">
            <div class="flex items-center justify-between">
              <div>
                <h2 class="text-2xl font-bold text-white mb-2">Recent Notifications</h2>
                <p class="text-gray-400">Stay updated with the latest activity</p>
              </div>
              <button onclick="markAllAsRead()" class="text-blue-400 hover:text-blue-300 font-medium transition-colors">Mark all as read</button>
            </div>
          </div>
          <div id="notificationsList" class="p-8">
            <div class="empty-state rounded-xl p-8 text-center">
              <div class="w-24 h-24 bg-gray-700/50 rounded-full flex items-center justify-center mx-auto mb-6 animate-bounce-gentle">
                <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM4 19h5v-5l-5 5z"></path>
                </svg>
              </div>
              <h3 class="text-xl font-semibold text-white mb-2">No notifications</h3>
              <p class="text-gray-400">You're all caught up! Check back later for updates</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Enhanced Floating Bottom Dock Navigation -->
  <nav class="fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50 dock-container animate-dock-slide-up">
    <div class="bg-white/25 dark:bg-gray-900/25 backdrop-blur-2xl border border-white/40 dark:border-gray-700/40 rounded-3xl shadow-2xl px-6 py-3 dock-background animate-dock-glow">
      <div class="flex items-center space-x-6 dock-items">
        <!-- Home -->
        <a href="./index.html" class="group flex flex-col items-center space-y-1 p-2 rounded-2xl transition-all duration-300 hover:bg-white/30 dark:hover:bg-gray-800/30 hover:scale-110 hover:-translate-y-1 dock-item">
          <div class="w-10 h-10 flex items-center justify-center dock-icon-container">
            <svg class="w-6 h-6 text-gray-600 dark:text-gray-400 group-hover:text-primary transition-all duration-300 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
            </svg>
          </div>
          <span class="text-xs font-semibold text-gray-700 dark:text-gray-300 group-hover:text-primary transition-all duration-300 dock-label">Home</span>
        </a>

        <!-- Browse -->
        <a href="./browse.html" class="group flex flex-col items-center space-y-1 p-2 rounded-2xl transition-all duration-300 hover:bg-white/30 dark:hover:bg-gray-800/30 hover:scale-110 hover:-translate-y-1 dock-item">
          <div class="w-10 h-10 flex items-center justify-center dock-icon-container">
            <svg class="w-6 h-6 text-gray-600 dark:text-gray-400 group-hover:text-primary transition-all duration-300 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
          <span class="text-xs font-semibold text-gray-700 dark:text-gray-300 group-hover:text-primary transition-all duration-300 dock-label">Browse</span>
        </a>

        <!-- Report Lost -->
        <a href="./report-lost.html" class="group flex flex-col items-center space-y-1 p-2 rounded-2xl transition-all duration-300 hover:bg-white/30 dark:hover:bg-gray-800/30 hover:scale-110 hover:-translate-y-1 dock-item">
          <div class="w-10 h-10 flex items-center justify-center dock-icon-container">
            <svg class="w-6 h-6 text-gray-600 dark:text-gray-400 group-hover:text-red-500 transition-all duration-300 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
            </svg>
          </div>
          <span class="text-xs font-semibold text-gray-700 dark:text-gray-300 group-hover:text-red-500 transition-all duration-300 dock-label">Lost</span>
        </a>

        <!-- Report Found -->
        <a href="./report-found.html" class="group flex flex-col items-center space-y-1 p-2 rounded-2xl transition-all duration-300 hover:bg-white/30 dark:hover:bg-gray-800/30 hover:scale-110 hover:-translate-y-1 dock-item">
          <div class="w-10 h-10 flex items-center justify-center dock-icon-container">
            <svg class="w-6 h-6 text-gray-600 dark:text-gray-400 group-hover:text-accent transition-all duration-300 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <span class="text-xs font-semibold text-gray-700 dark:text-gray-300 group-hover:text-accent transition-all duration-300 dock-label">Found</span>
        </a>

        <!-- Messages -->
        <a href="./messages.html" class="group flex flex-col items-center space-y-1 p-2 rounded-2xl transition-all duration-300 hover:bg-white/30 dark:hover:bg-gray-800/30 hover:scale-110 hover:-translate-y-1 dock-item relative">
          <div class="w-10 h-10 flex items-center justify-center dock-icon-container">
            <svg class="w-6 h-6 text-gray-600 dark:text-gray-400 group-hover:text-primary transition-all duration-300 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
            </svg>
            <span class="chat-unread-badge hidden absolute top-0 right-0 bg-red-500 text-white text-xs font-bold px-1.5 py-0.5 rounded-full min-w-[1.25rem] text-center"></span>
          </div>
          <span class="text-xs font-semibold text-gray-700 dark:text-gray-300 group-hover:text-primary transition-all duration-300 dock-label">Messages</span>
        </a>

        <!-- User Dashboard (Active) -->
        <a href="./user-dashboard.html" class="group flex flex-col items-center space-y-1 p-2 rounded-2xl transition-all duration-300 hover:bg-white/30 dark:hover:bg-gray-800/30 hover:scale-110 hover:-translate-y-1 dock-item">
          <div class="w-10 h-10 flex items-center justify-center dock-icon-container">
            <svg class="w-6 h-6 text-primary group-hover:text-primary-light transition-all duration-300 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
          </div>
          <span class="text-xs font-semibold text-primary transition-all duration-300 dock-label">Dashboard</span>
        </a>

        <!-- Theme Toggle -->
        <button id="dockThemeToggle" class="group flex flex-col items-center space-y-1 p-2 rounded-2xl transition-all duration-300 hover:bg-white/30 dark:hover:bg-gray-800/30 hover:scale-110 hover:-translate-y-1 dock-item">
          <div class="w-10 h-10 flex items-center justify-center dock-icon-container">
            <svg class="w-6 h-6 text-gray-600 dark:text-gray-400 group-hover:text-accent transition-all duration-300 group-hover:scale-110" fill="currentColor" viewBox="0 0 20 20">
              <path d="M17.293 13.293A8 8 0 716.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
            </svg>
          </div>
          <span class="text-xs font-semibold text-gray-700 dark:text-gray-300 group-hover:text-accent transition-all duration-300 dock-label">Theme</span>
        </button>

        <!-- User Profile Menu -->
        <div id="dockUserMenu" class="group relative">
          <button id="dockUserMenuButton" class="flex flex-col items-center space-y-1 p-2 rounded-2xl transition-all duration-300 hover:bg-white/30 dark:hover:bg-gray-800/30 hover:scale-110 hover:-translate-y-1 dock-item">
            <div class="w-10 h-10 flex items-center justify-center dock-icon-container">
              <div id="dockUserAvatarContainer" class="w-8 h-8 rounded-full bg-primary flex items-center justify-center">
                <img id="dockUserAvatar" class="w-8 h-8 rounded-full hidden" src="" alt="">
                <svg id="dockDefaultAvatar" class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                </svg>
              </div>
            </div>
            <span class="text-xs font-semibold text-gray-700 dark:text-gray-300 group-hover:text-primary transition-all duration-300 dock-label" id="dockUserName">User</span>
          </button>
          
          <!-- Profile Dropdown Menu -->
          <div id="dockProfileDropdown" class="hidden absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 w-48 bg-white/95 dark:bg-gray-800/95 backdrop-blur-xl border border-white/30 dark:border-gray-700/30 rounded-xl shadow-2xl z-50">
            <div class="py-2">
              <!-- User Info -->
              <div class="px-4 py-3 border-b border-gray-200/50 dark:border-gray-700/50">
                <div class="flex items-center space-x-3">
                  <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center">
                    <img id="dockDropdownUserAvatar" class="w-8 h-8 rounded-full hidden" src="" alt="">
                    <svg id="dockDropdownDefaultAvatar" class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                    </svg>
                  </div>
                  <div>
                    <p id="dockDropdownUserName" class="text-sm font-medium text-gray-900 dark:text-white"></p>
                    <p class="text-xs text-gray-500 dark:text-gray-400">Profile</p>
                  </div>
                </div>
              </div>
              
              <!-- Menu Items -->
              <div class="py-1">
                <a href="./user-dashboard.html" class="flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-primary/10 dark:hover:bg-primary/20 transition-colors duration-200">
                  <svg class="w-4 h-4 mr-3 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                  </svg>
                  Dashboard
                </a>
                
                <button id="dockEditProfileBtn" class="flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-primary/10 dark:hover:bg-primary/20 transition-colors duration-200">
                  <svg class="w-4 h-4 mr-3 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                  </svg>
                  Edit Profile
                </button>
                
                <button id="dockChangePasswordBtn" class="flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-primary/10 dark:hover:bg-primary/20 transition-colors duration-200">
                  <svg class="w-4 h-4 mr-3 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                  </svg>
                  Change Password
                </button>
                
                <div class="border-t border-gray-200/50 dark:border-gray-700/50 my-1"></div>
                
                <button id="dockLogoutBtn" class="flex items-center w-full px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors duration-200">
                  <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                  </svg>
                  Sign Out
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Enhanced Footer -->
  <footer class="bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-900 dark:to-black relative overflow-hidden">
    <!-- Background decoration -->
    <div class="absolute inset-0 bg-gradient-to-br from-primary/10 to-accent/10 dark:from-primary/5 dark:to-accent/5"></div>
    
    <!-- Floating background elements with persistent animations -->
    <div class="absolute top-10 left-10 w-32 h-32 bg-blue-500/10 dark:bg-blue-500/5 rounded-full" style="animation: float 6s ease-in-out infinite;"></div>
    <div class="absolute bottom-10 right-20 w-24 h-24 bg-purple-500/10 dark:bg-purple-500/5 rounded-full" style="animation: float 6s ease-in-out infinite; animation-delay: 2s;"></div>
    <div class="absolute top-1/2 right-1/4 w-16 h-16 bg-green-500/10 dark:bg-green-500/5 rounded-full" style="animation: float 6s ease-in-out infinite; animation-delay: 4s;"></div>
    
    <!-- Additional floating elements for more dynamic effect -->
    <div class="absolute top-1/4 left-1/3 w-20 h-20 bg-yellow-500/6 dark:bg-yellow-500/3 rounded-full" style="animation: float 8s ease-in-out infinite; animation-delay: 1s;"></div>
    <div class="absolute bottom-1/4 left-1/4 w-14 h-14 bg-pink-500/6 dark:bg-pink-500/3 rounded-full" style="animation: float 7s ease-in-out infinite; animation-delay: 3s;"></div>
    
    <style>
      @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        25% { transform: translateY(-10px) rotate(2deg); }
        50% { transform: translateY(-20px) rotate(0deg); }
        75% { transform: translateY(-10px) rotate(-2deg); }
      }
      
      @keyframes bounce-gentle {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
      }
      
      .animate-bounce-gentle {
        animation: bounce-gentle 2s ease-in-out infinite;
      }
      
      .gradient-text {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
    </style>
    
    <div class="w-full px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-16 py-16 relative z-10">
      <div class="grid grid-cols-1 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-8 mb-12">
        <!-- Brand Section -->
        <div class="col-span-1 md:col-span-2 lg:col-span-2 xl:col-span-3 2xl:col-span-4 animate-on-scroll">
          <div class="flex items-center mb-6">
            <div class="w-12 h-12 bg-gradient-to-r from-primary to-accent rounded-xl flex items-center justify-center mr-4 shadow-lg animate-bounce-gentle">
              <svg class="w-7 h-7 text-white" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
              </svg>
            </div>
            <span class="text-2xl font-bold text-gray-900 dark:text-white">LOAF</span>
          </div>
          <p class="text-gray-700 dark:text-gray-300 mb-6 text-lg leading-relaxed max-w-md">
            Making campus recovery faster and easier with AI-powered matching. 
            <span class="gradient-text font-semibold">Reuniting students with their belongings.</span>
          </p>
          
          <!-- Social Links -->
          <div class="flex space-x-4">
            <a href="#" class="w-10 h-10 bg-gray-800/10 hover:bg-gray-800/20 dark:bg-white/10 dark:hover:bg-white/20 rounded-lg flex items-center justify-center transition-all duration-300 hover:scale-110 group">
              <svg class="w-5 h-5 text-gray-700 group-hover:text-gray-900 dark:text-gray-300 dark:group-hover:text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"/>
              </svg>
            </a>
            <a href="#" class="w-10 h-10 bg-white/10 hover:bg-white/20 rounded-lg flex items-center justify-center transition-all duration-300 hover:scale-110 group">
              <svg class="w-5 h-5 text-gray-300 group-hover:text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/>
              </svg>
            </a>
            <a href="#" class="w-10 h-10 bg-gray-800/10 hover:bg-gray-800/20 dark:bg-white/10 dark:hover:bg-white/20 rounded-lg flex items-center justify-center transition-all duration-300 hover:scale-110 group">
              <svg class="w-5 h-5 text-gray-700 group-hover:text-gray-900 dark:text-gray-300 dark:group-hover:text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.174-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.75-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24.009 12.017 24.009c6.624 0 11.99-5.367 11.99-11.988C24.007 5.367 18.641.001.012.017 0z"/>
              </svg>
            </a>
            <a href="#" class="w-10 h-10 bg-gray-800/10 hover:bg-gray-800/20 dark:bg-white/10 dark:hover:bg-white/20 rounded-lg flex items-center justify-center transition-all duration-300 hover:scale-110 group">
              <svg class="w-5 h-5 text-gray-700 group-hover:text-gray-900 dark:text-gray-300 dark:group-hover:text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
            </a>
          </div>
        </div>
        
        <!-- Quick Links -->
        <div class="animate-on-scroll" style="animation-delay: 0.1s;">
          <h3 class="text-sm font-bold text-gray-900 dark:text-white uppercase tracking-wider mb-6 flex items-center">
            <svg class="w-4 h-4 mr-2 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
            Quick Links
          </h3>
          <ul class="space-y-3">
            <li><a href="./browse.html" class="text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors duration-200 flex items-center group">
              <svg class="w-4 h-4 mr-2 text-gray-600 dark:text-gray-400 group-hover:text-blue-400 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
              Browse Items
            </a></li>
            <li><a href="./report-lost.html" class="text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors duration-200 flex items-center group">
              <svg class="w-4 h-4 mr-2 text-gray-600 dark:text-gray-400 group-hover:text-red-400 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
              </svg>
              Report Lost
            </a></li>
            <li><a href="./report-found.html" class="text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors duration-200 flex items-center group">
              <svg class="w-4 h-4 mr-2 text-gray-600 dark:text-gray-400 group-hover:text-green-400 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              Report Found
            </a></li>
          </ul>
        </div>
        
        <!-- Support -->
        <div class="animate-on-scroll" style="animation-delay: 0.2s;">
          <h3 class="text-sm font-bold text-gray-900 dark:text-white uppercase tracking-wider mb-6 flex items-center">
            <svg class="w-4 h-4 mr-2 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192L5.636 18.364M12 2.25a9.75 9.75 0 100 19.5 9.75 9.75 0 000-19.5z"></path>
            </svg>
            Support
          </h3>
          <ul class="space-y-3">
            <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors duration-200 flex items-center group">
              <svg class="w-4 h-4 mr-2 text-gray-600 dark:text-gray-400 group-hover:text-blue-400 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              Help Center
            </a></li>
            <li><a href="./index.html#contact" class="text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors duration-200 flex items-center group">
              <svg class="w-4 h-4 mr-2 text-gray-600 dark:text-gray-400 group-hover:text-green-400 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
              </svg>
              Contact Us
            </a></li>
            <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors duration-200 flex items-center group">
              <svg class="w-4 h-4 mr-2 text-gray-600 dark:text-gray-400 group-hover:text-purple-400 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
              </svg>
              Privacy Policy
            </a></li>
          </ul>
        </div>
      </div>
      
      <!-- Bottom Section -->
      <div class="border-t border-gray-300 dark:border-gray-700 pt-8 animate-on-scroll" style="animation-delay: 0.3s;">
        <div class="flex flex-col md:flex-row justify-between items-center">
          <div class="flex items-center mb-4 md:mb-0">
            <p class="text-gray-600 dark:text-gray-400 text-sm">
              &copy; 2025 CampusFound. All rights reserved.
            </p>
            <div class="ml-4 flex items-center">
              <span class="text-gray-500 dark:text-gray-500 text-xs">Made with</span>
              <svg class="w-4 h-4 text-red-500 mx-1 animate-bounce-gentle" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
              </svg>
              <span class="text-gray-500 dark:text-gray-500 text-xs">for students</span>
            </div>
          </div>
          
          <div class="flex items-center space-x-6">
            <a href="#" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white text-sm transition-colors duration-200">Terms of Service</a>
            <a href="#" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white text-sm transition-colors duration-200">Privacy Policy</a>
            <a href="#" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white text-sm transition-colors duration-200">Cookies</a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- Edit Report Modal -->
  <div id="editReportModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4" onclick="if(event.target === this) closeEditModal()">
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6 border-b border-gray-200 dark:border-gray-700">
        <div class="flex items-center justify-between">
          <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Edit Report</h2>
          <button onclick="closeEditModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
      </div>
      
      <form id="editReportForm" class="p-6 space-y-4">
        <input type="hidden" id="editReportId">
        
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Title</label>
          <input type="text" id="editTitle" required
            class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Description</label>
          <textarea id="editDescription" rows="4" required
            class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white"></textarea>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Location</label>
          <input type="text" id="editLocation" required
            class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Status</label>
          <select id="editStatus" required
            class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary dark:bg-gray-700 dark:text-white">
            <option value="open">Open</option>
            <option value="matched">Matched</option>
            <option value="closed">Closed</option>
          </select>
        </div>
        
        <div class="flex justify-end space-x-3 pt-4">
          <button type="button" onclick="closeEditModal()"
            class="px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
            Cancel
          </button>
          <button type="submit"
            class="px-6 py-2 bg-gradient-to-r from-primary to-accent text-white rounded-lg hover:shadow-lg">
            Save Changes
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="../js/api.js"></script>
  <script src="../js/chat.js"></script>
  <script src="../js/theme.js"></script>
  <script src="../js/ui.js"></script>
  <script src="../js/user-dropdown.js"></script>
  <script>
    let currentUser = null;

    // Initialize dashboard
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        await checkAuthAndLoadUser();
        await loadDashboardData();
      } catch (error) {
        console.error('Dashboard initialization error:', error);
        // Don't show alert here, it's handled in checkAuthAndLoadUser
      }
    });

    // Check authentication and load user data
    async function checkAuthAndLoadUser() {
      try {
        // Check for redirect loop prevention
        const redirectCount = sessionStorage.getItem('redirectCount') || '0';
        if (parseInt(redirectCount) > 3) {
          console.error('Too many redirects detected, clearing all data');
          localStorage.clear();
          sessionStorage.clear();
          alert('Authentication error detected. Please try logging in again.');
          window.location.href = './login.html';
          return;
        }

        // Debug: Check current tokens
        const tokens = JSON.parse(localStorage.getItem('tokens') || '{}');
        console.log('Dashboard: Current tokens:', tokens);
        
        // Try to get user data from API (this will handle token validation)
        console.log('Dashboard: Attempting to authenticate user');
        currentUser = await window.api.users.me();
        console.log('Dashboard: Authentication successful, user:', currentUser);
        window.currentUser = currentUser;
        showUserMenu(currentUser);
        
        // Clear redirect count on successful auth
        sessionStorage.removeItem('redirectCount');
        
      } catch (error) {
        console.error('Authentication failed:', error);
        console.error('Error details:', error.response?.status, error.response?.data);
        
        // Only redirect if it's actually an authentication error (401) and we've tried refresh
        if (error.response?.status === 401) {
          // Check if we have any tokens at all
          const tokens = JSON.parse(localStorage.getItem('tokens') || '{}');
          
          if (!tokens.access && !tokens.refresh) {
            console.log('Dashboard: No tokens available, redirecting to login');
            // Increment redirect count
            const redirectCount = parseInt(sessionStorage.getItem('redirectCount') || '0') + 1;
            sessionStorage.setItem('redirectCount', redirectCount.toString());
            
            // Add a small delay to prevent redirect loops
            setTimeout(() => {
              window.location.href = './login.html?redirect=' + encodeURIComponent(window.location.pathname);
            }, 100);
          } else {
            // We have tokens but still getting 401, might be a temporary issue
            console.log('Dashboard: Have tokens but got 401, showing retry option');
            const retry = confirm('Authentication failed. This might be a temporary issue. Would you like to try again?');
            if (retry) {
              window.location.reload();
            } else {
              window.location.href = './login.html';
            }
          }
        } else {
          // For other errors, log and show a user-friendly message
          console.log('Dashboard: Non-auth error');
          console.error('Error details:', error);
          // Don't throw error, just log it - dashboard data loading will handle its own errors
        }
      }
    }

    // Show user menu when logged in
    function showUserMenu(user) {
      document.getElementById('userName').textContent = user.username;
      
      // Update dock user name
      const dockUserName = document.getElementById('dockUserName');
      if (dockUserName) {
        dockUserName.textContent = user.username;
      }
      
      // Update dock dropdown user info
      const dockDropdownUserName = document.getElementById('dockDropdownUserName');
      if (dockDropdownUserName) {
        dockDropdownUserName.textContent = user.username;
      }
      
      // Update dropdown user info
      document.getElementById('dropdownUserName').textContent = user.username;
      document.getElementById('dropdownUserEmail').textContent = user.email || 'No email provided';
      
      // Handle main avatar
      const userAvatar = document.getElementById('userAvatar');
      const defaultAvatar = document.getElementById('defaultAvatar');
      
      // Handle dropdown avatar
      const dropdownAvatar = document.getElementById('dropdownAvatar');
      const dropdownDefaultAvatar = document.getElementById('dropdownDefaultAvatar');
      
      if (user.avatar) {
        // User has custom avatar
        userAvatar.src = user.avatar;
        userAvatar.classList.remove('hidden');
        defaultAvatar.classList.add('hidden');
        
        dropdownAvatar.src = user.avatar;
        dropdownAvatar.classList.remove('hidden');
        dropdownDefaultAvatar.classList.add('hidden');
      } else {
        // Show default profile icon
        userAvatar.classList.add('hidden');
        defaultAvatar.classList.remove('hidden');
        
        dropdownAvatar.classList.add('hidden');
        dropdownDefaultAvatar.classList.remove('hidden');
      }
    }

    // Load all dashboard data
    async function loadDashboardData() {
      await Promise.all([
        loadDashboardStats(),
        window.loadMyReports(),
        window.loadMatches(),
        window.loadNotifications()
      ]);
    }

    // Load dashboard statistics
    async function loadDashboardStats() {
      try {
        const stats = await window.api.dashboard.stats();
        
        // Get unread message count from chat
        let unreadMessages = 0;
        try {
          const chatUnread = await window.api.chat.getUnreadCount();
          unreadMessages = chatUnread.unread_count || 0;
        } catch (chatError) {
          console.error('Failed to load chat unread count:', chatError);
        }
        
        // Update stats cards with null checks
        const totalReportsEl = document.getElementById('totalReports');
        const activeMatchesEl = document.getElementById('activeMatches');
        const resolvedItemsEl = document.getElementById('resolvedItems');
        const notificationCountEl = document.getElementById('notificationCount');
        
        if (totalReportsEl) totalReportsEl.textContent = stats.total_reports;
        if (activeMatchesEl) activeMatchesEl.textContent = stats.active_matches;
        if (resolvedItemsEl) resolvedItemsEl.textContent = stats.resolved_items;
        
        // Combine notifications and unread messages
        const totalNotifications = (stats.notifications || 0) + unreadMessages;
        if (notificationCountEl) notificationCountEl.textContent = totalNotifications;
        
        // Update badge title
        if (notificationCountEl && unreadMessages > 0) {
          const notificationCard = notificationCountEl.closest('.card');
          if (notificationCard) {
            const titleEl = notificationCard.querySelector('h3');
            if (titleEl) {
              titleEl.textContent = `Alerts (${unreadMessages} unread messages)`;
            }
          }
        }
      } catch (error) {
        console.error('Failed to load dashboard stats:', error);
        // Set default values on error with null checks
        const totalReportsEl = document.getElementById('totalReports');
        const activeMatchesEl = document.getElementById('activeMatches');
        const resolvedItemsEl = document.getElementById('resolvedItems');
        const notificationCountEl = document.getElementById('notificationCount');
        
        if (totalReportsEl) totalReportsEl.textContent = '0';
        if (activeMatchesEl) activeMatchesEl.textContent = '0';
        if (resolvedItemsEl) resolvedItemsEl.textContent = '0';
        if (notificationCountEl) notificationCountEl.textContent = '0';
      }
    }

    // Tab switching functionality
    window.switchTab = function(tabName) {
      // Hide all tab contents
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.add('hidden');
      });
      
      // Remove active state from all tabs
      document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('bg-gradient-to-r', 'from-primary', 'to-accent', 'text-white', 'shadow-lg');
        button.classList.add('text-gray-400');
      });
      
      // Show selected tab content
      const contentEl = document.getElementById(tabName + 'Content');
      if (contentEl) {
        contentEl.classList.remove('hidden');
      }
      
      // Add active state to selected tab
      const activeTab = document.getElementById(tabName + 'Tab');
      if (activeTab) {
        activeTab.classList.remove('text-gray-400');
        activeTab.classList.add('bg-gradient-to-r', 'from-primary', 'to-accent', 'text-white', 'shadow-lg');
      }
    };

    // Load user's reports - Make globally accessible
    window.loadMyReports = async function() {
      try {
        const data = await window.api.dashboard.reports();
        renderReportsTable(data.results || []);
      } catch (error) {
        console.error('Failed to load reports:', error);
        showReportsError();
      }
    };

    // Render reports table
    function renderReportsTable(reports) {
      const tbody = document.getElementById('reportsTableBody');
      if (!tbody) {
        console.warn('Reports table body not found');
        return;
      }
      
      if (reports.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="5" class="px-6 py-8 text-center text-gray-400">
              <div class="text-center">
                <svg class="w-12 h-12 mx-auto mb-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <p class="text-lg font-medium mb-2">No reports yet</p>
                <p>Start by reporting a lost or found item.</p>
                <a href="./report-lost.html" class="btn-primary mt-4 inline-block">Report Item</a>
              </div>
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = reports.map(report => `
        <tr class="hover:bg-gray-700 transition-colors">
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="flex items-center">
              <div class="flex-shrink-0 h-10 w-10">
                ${report.image ? 
                  `<img class="h-10 w-10 rounded-lg object-cover" src="${report.image}" alt="${report.title}">` :
                  `<div class="h-10 w-10 rounded-lg bg-gray-600 flex items-center justify-center">
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                  </div>`
                }
              </div>
              <div class="ml-4">
                <div class="text-sm font-medium text-white">${report.title}</div>
                <div class="text-sm text-gray-400">${report.location || 'No location'}</div>
              </div>
            </div>
          </td>
          <td class="px-6 py-4">
            <div class="text-sm text-gray-300 max-w-xs truncate">${report.description || 'No description'}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
            ${new Date(report.created_at).toLocaleDateString()}
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span class="badge-${report.report_type === 'lost' ? 'lost' : 'found'}">
              ${report.report_type?.toUpperCase() || 'UNKNOWN'}
            </span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
            <button onclick="viewReport('${report.id}')" class="text-blue-400 hover:text-blue-300 mr-3">View</button>
            <button onclick="editReport('${report.id}')" class="text-green-400 hover:text-green-300 mr-3">Edit</button>
            <button onclick="deleteReport('${report.id}')" class="text-red-400 hover:text-red-300">Delete</button>
          </td>
        </tr>
      `).join('');
    }

    // Show reports error
    function showReportsError() {
      const tbody = document.getElementById('reportsTableBody');
      tbody.innerHTML = `
        <tr>
          <td colspan="5" class="px-6 py-8 text-center text-red-400">
            <p>Failed to load reports. Please try again.</p>
            <button onclick="loadMyReports()" class="btn-primary mt-4">Retry</button>
          </td>
        </tr>
      `;
    }

    // Load matches - Make globally accessible
    window.loadMatches = async function() {
      try {
        const data = await window.api.dashboard.matches();
        renderMatches(data.results || []);
      } catch (error) {
        console.error('Failed to load matches:', error);
        showMatchesError();
      }
    };

    // Render matches
    function renderMatches(matches) {
      const container = document.getElementById('matchesList');
      
      if (matches.length === 0) {
        container.innerHTML = `
          <div class="text-center text-gray-400 py-8">
            <svg class="w-12 h-12 mx-auto mb-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            <p class="text-lg font-medium mb-2">No matches found</p>
            <p>We'll notify you when potential matches are discovered.</p>
          </div>
        `;
        return;
      }

      container.innerHTML = matches.map(match => `
        <div class="bg-gray-700 rounded-lg p-4 mb-4">
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-white font-medium">Match Found!</h3>
            <div class="flex items-center space-x-2">
              <span class="text-sm text-gray-400">${Math.round(match.confidence_score * 100)}% confidence</span>
              <span class="badge-${match.status}">${match.status.toUpperCase()}</span>
            </div>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
            <div class="border border-gray-600 rounded-lg p-3">
              <h4 class="text-sm font-medium text-gray-300 mb-2">Your Report</h4>
              <div class="flex items-center space-x-3">
                ${match.user_report.image ? 
                  `<img class="w-12 h-12 rounded-lg object-cover" src="${match.user_report.image}" alt="${match.user_report.title}">` :
                  `<div class="w-12 h-12 rounded-lg bg-gray-600 flex items-center justify-center">
                    <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                  </div>`
                }
                <div>
                  <p class="text-white text-sm font-medium">${match.user_report.title}</p>
                  <p class="text-gray-400 text-xs">${match.user_report.report_type.toUpperCase()}</p>
                </div>
              </div>
            </div>
            <div class="border border-gray-600 rounded-lg p-3">
              <h4 class="text-sm font-medium text-gray-300 mb-2">Matched Report</h4>
              <div class="flex items-center space-x-3">
                ${match.matched_report.image ? 
                  `<img class="w-12 h-12 rounded-lg object-cover" src="${match.matched_report.image}" alt="${match.matched_report.title}">` :
                  `<div class="w-12 h-12 rounded-lg bg-gray-600 flex items-center justify-center">
                    <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                  </div>`
                }
                <div>
                  <p class="text-white text-sm font-medium">${match.matched_report.title}</p>
                  <p class="text-gray-400 text-xs">${match.matched_report.report_type.toUpperCase()} by ${match.matched_report.reported_by}</p>
                </div>
              </div>
            </div>
          </div>
          ${match.status === 'pending' ? `
            <div class="flex space-x-3">
              <button onclick="confirmMatch('${match.id}')" class="btn-primary text-sm">Confirm Match</button>
              <button onclick="rejectMatch('${match.id}')" class="btn-secondary text-sm">Not a Match</button>
            </div>
          ` : `
            <p class="text-gray-400 text-sm">Match ${match.status} on ${new Date(match.resolved_at || match.created_at).toLocaleDateString()}</p>
          `}
        </div>
      `).join('');
    }

    // Show matches error
    function showMatchesError() {
      document.getElementById('matchesList').innerHTML = `
        <div class="text-center text-red-400 py-8">
          <p>Failed to load matches. Please try again.</p>
          <button onclick="loadMatches()" class="btn-primary mt-4">Retry</button>
        </div>
      `;
    }

    // Load notifications - Make globally accessible
    window.loadNotifications = async function() {
      try {
        // Fetch system notifications
        const data = await window.api.dashboard.notifications();
        const systemNotifications = data.results || [];
        
        // Fetch unread messages
        let messageNotifications = [];
        try {
          const conversations = await window.api.chat.getConversations();
          const conversationsData = conversations.results || conversations;
          
          // Create notifications for conversations with unread messages
          messageNotifications = conversationsData
            .filter(conv => conv.unread_count > 0)
            .map(conv => {
              const otherUser = conv.lost_user?.id === window.currentUserId ? conv.found_user : conv.lost_user;
              const report = conv.lost_report || conv.found_report;
              
              return {
                id: `message_${conv.id}`,
                type: 'message',
                conversation_id: conv.id,
                message: `New message from ${otherUser?.username || 'User'} about "${report?.title || 'item'}"`,
                sender: otherUser?.username || 'User',
                unread_count: conv.unread_count,
                created_at: conv.last_message?.created_at || conv.updated_at,
                is_read: false
              };
            });
        } catch (chatError) {
          console.error('Failed to load message notifications:', chatError);
        }
        
        // Combine and sort all notifications by date
        const allNotifications = [...systemNotifications, ...messageNotifications]
          .sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
        
        renderNotifications(allNotifications);
        
        // Update badge count
        const unreadCount = systemNotifications.filter(n => !n.is_read).length + messageNotifications.length;
        updateNotificationBadge(unreadCount);
      } catch (error) {
        console.error('Failed to load notifications:', error);
        showNotificationsError();
      }
    };

    // Render notifications
    function renderNotifications(notifications) {
      const container = document.getElementById('notificationsList');
      if (!container) {
        console.warn('Notifications container not found');
        return;
      }
      
      if (notifications.length === 0) {
        container.innerHTML = `
          <div class="text-center text-gray-400 py-8">
            <svg class="w-12 h-12 mx-auto mb-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM4 19h5v-5l-5 5z"></path>
            </svg>
            <p class="text-lg font-medium mb-2">No notifications</p>
            <p>You're all caught up!</p>
          </div>
        `;
        return;
      }

      container.innerHTML = notifications.map(notification => {
        const isMessage = notification.type === 'message';
        const clickHandler = isMessage ? 
          `onclick="window.location.href='./messages.html?conversation=${notification.conversation_id}'" style="cursor: pointer;"` : '';
        
        return `
        <div class="bg-gray-700 rounded-lg p-4 mb-4 ${!notification.is_read ? 'border-l-4 border-blue-500' : ''} ${isMessage ? 'hover:bg-gray-600 transition-colors' : ''}" ${clickHandler}>
          <div class="flex items-start justify-between">
            <div class="flex-1">
              ${isMessage ? `
                <div class="flex items-center space-x-2 mb-2">
                  <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                  </svg>
                  <span class="text-blue-400 font-semibold text-sm">New Message</span>
                  ${notification.unread_count > 1 ? `<span class="bg-blue-500 text-white text-xs px-2 py-0.5 rounded-full">${notification.unread_count}</span>` : ''}
                </div>
              ` : ''}
              <p class="text-gray-300 text-sm mb-2">${notification.message}</p>
              <span class="text-xs text-gray-400">${new Date(notification.created_at).toLocaleString()}</span>
            </div>
            ${!notification.is_read && !isMessage ? 
              `<button onclick="markAsRead('${notification.id}')" class="text-blue-400 hover:text-blue-300 text-sm">Mark as read</button>` :
              isMessage ? `<span class="text-blue-400 text-sm">Click to view </span>` : ''
            }
          </div>
        </div>
      `;
      }).join('');
    }

    // Show notifications error
    function showNotificationsError() {
      const container = document.getElementById('notificationsList');
      if (!container) {
        console.warn('Notifications container not found');
        return;
      }
      container.innerHTML = `
        <div class="text-center text-red-400 py-8">
          <p>Failed to load notifications. Please try again.</p>
          <button onclick="loadNotifications()" class="btn-primary mt-4">Retry</button>
        </div>
      `;
    }

    // Update notification badge
    function updateNotificationBadge(count) {
      const badge = document.getElementById('notificationBadge');
      if (!badge) {
        console.warn('Notification badge element not found');
        return;
      }
      if (count > 0) {
        badge.textContent = count;
        badge.classList.remove('hidden');
      } else {
        badge.classList.add('hidden');
      }
    }

    // Action handlers - Make globally accessible
    window.viewReport = function(reportId) {
      // Navigate to browse page with the report highlighted
      window.location.href = `./browse.html?report=${reportId}`;
    };

    window.editReport = async function(reportId) {
      try {
        // Fetch the report details
        const report = await window.api.reports.get(reportId);
        
        // Populate the form
        document.getElementById('editReportId').value = report.id;
        document.getElementById('editTitle').value = report.title;
        document.getElementById('editDescription').value = report.description;
        document.getElementById('editLocation').value = report.location || '';
        document.getElementById('editStatus').value = report.status;
        
        // Show the modal
        document.getElementById('editReportModal').classList.remove('hidden');
      } catch (error) {
        console.error('Failed to load report:', error);
        alert('Failed to load report details. Please try again.');
      }
    };

    window.closeEditModal = function() {
      document.getElementById('editReportModal').classList.add('hidden');
      document.getElementById('editReportForm').reset();
    };

    // Close modal with Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        const modal = document.getElementById('editReportModal');
        if (modal && !modal.classList.contains('hidden')) {
          closeEditModal();
        }
      }
    });

    // Handle edit form submission
    document.getElementById('editReportForm')?.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const reportId = document.getElementById('editReportId').value;
      const submitBtn = e.target.querySelector('button[type="submit"]');
      const originalText = submitBtn.textContent;
      
      // Create FormData object (API expects multipart/form-data)
      const formData = new FormData();
      formData.append('title', document.getElementById('editTitle').value);
      formData.append('description', document.getElementById('editDescription').value);
      formData.append('location', document.getElementById('editLocation').value);
      formData.append('status', document.getElementById('editStatus').value);
      
      try {
        // Show loading state
        submitBtn.disabled = true;
        submitBtn.textContent = 'Saving...';
        
        await window.api.reports.update(reportId, formData);
        alert('Report updated successfully!');
        closeEditModal();
        await window.loadMyReports(); // Reload the table
        await loadDashboardStats(); // Update stats
      } catch (error) {
        console.error('Failed to update report:', error);
        alert('Failed to update report. Please try again.');
      } finally {
        // Restore button state
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
      }
    });

    window.deleteReport = async function(reportId) {
      if (confirm('Are you sure you want to delete this report? This action cannot be undone.')) {
        try {
          await window.api.reports.remove(reportId);
          await window.loadMyReports(); // Reload the table
          await loadDashboardStats(); // Update stats
          alert('Report deleted successfully!');
        } catch (error) {
          console.error('Failed to delete report:', error);
          alert('Failed to delete report. Please try again.');
        }
      }
    };

    window.confirmMatch = async function(matchId) {
      if (confirm('Confirm this match? This will mark both items as found/returned.')) {
        try {
          await window.api.dashboard.confirmMatch(matchId);
          await window.loadMatches(); // Reload matches
          await loadDashboardStats(); // Update stats
          alert('Match confirmed successfully!');
        } catch (error) {
          console.error('Failed to confirm match:', error);
          alert('Failed to confirm match. Please try again.');
        }
      }
    };

    window.rejectMatch = async function(matchId) {
      if (confirm('Reject this match? This indicates these items do not match.')) {
        try {
          await window.api.dashboard.rejectMatch(matchId);
          await window.loadMatches(); // Reload matches
          await loadDashboardStats(); // Update stats
          alert('Match rejected successfully!');
        } catch (error) {
          console.error('Failed to reject match:', error);
          alert('Failed to reject match. Please try again.');
        }
      }
    };

    window.markAsRead = async function(notificationId) {
      try {
        await window.api.dashboard.markNotificationRead(notificationId);
        await window.loadNotifications(); // Reload notifications
        await loadDashboardStats(); // Update stats
      } catch (error) {
        console.error('Failed to mark notification as read:', error);
        alert('Failed to mark notification as read.');
      }
    };

    window.markAllAsRead = async function() {
      try {
        // Get all system notifications and mark them as read
        const data = await window.api.dashboard.notifications();
        const systemNotifications = data.results || [];
        const unreadSystemNotifications = systemNotifications.filter(n => !n.is_read);
        
        // Mark all system notifications as read
        const promises = unreadSystemNotifications.map(n => 
          window.api.dashboard.markNotificationRead(n.id).catch(err => {
            console.error('Failed to mark notification as read:', n.id, err);
          })
        );
        
        await Promise.all(promises);
        
        // Note: Message notifications are automatically cleared when user views the conversation
        // So we don't need to explicitly mark them as read here
        
        alert('All notifications marked as read!');
        await window.loadNotifications(); // Reload notifications
        await loadDashboardStats(); // Update stats
      } catch (error) {
        console.error('Failed to mark all notifications as read:', error);
        alert('Failed to mark all notifications as read.');
      }
    };

    // Report Item Button Functionality
    document.addEventListener('DOMContentLoaded', function() {
      const reportItemBtn = document.getElementById('reportItemBtn');
      const reportDropdown = document.getElementById('reportDropdown');
      const dockUserMenuButton = document.getElementById('dockUserMenuButton');
      const dockProfileDropdown = document.getElementById('dockProfileDropdown');

      // Report Item Dropdown Toggle
      if (reportItemBtn && reportDropdown) {
        reportItemBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          reportDropdown.classList.toggle('hidden');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
          if (!reportItemBtn.contains(e.target) && !reportDropdown.contains(e.target)) {
            reportDropdown.classList.add('hidden');
          }
        });
      }

      // Dock User Menu Toggle
      if (dockUserMenuButton && dockProfileDropdown) {
        dockUserMenuButton.addEventListener('click', function(e) {
          e.stopPropagation();
          dockProfileDropdown.classList.toggle('hidden');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
          if (!dockUserMenuButton.contains(e.target) && !dockProfileDropdown.contains(e.target)) {
            dockProfileDropdown.classList.add('hidden');
          }
        });
      }

      // Theme Toggle Functionality
      const dockThemeToggle = document.getElementById('dockThemeToggle');
      if (dockThemeToggle) {
        dockThemeToggle.addEventListener('click', function() {
          document.documentElement.classList.toggle('dark');
          localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
        });
      }

      // Load saved theme
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark') {
        document.documentElement.classList.add('dark');
      }

      // Enhanced Tab Functionality
      window.switchTab = function(tabName) {
        // Remove active class from all tabs
        document.querySelectorAll('.tab-button').forEach(tab => {
          tab.classList.remove('bg-gradient-to-r', 'from-primary', 'to-accent', 'text-white', 'shadow-lg');
          tab.classList.add('text-gray-400', 'hover:text-white', 'hover:bg-gray-700/50');
        });

        // Add active class to clicked tab
        const activeTab = document.getElementById(tabName + 'Tab');
        if (activeTab) {
          activeTab.classList.add('bg-gradient-to-r', 'from-primary', 'to-accent', 'text-white', 'shadow-lg');
          activeTab.classList.remove('text-gray-400', 'hover:text-white', 'hover:bg-gray-700/50');
        }

        // Hide all tab content
        document.querySelectorAll('.tab-content').forEach(content => {
          content.classList.add('hidden');
        });

        // Show selected tab content
        const activeContent = document.getElementById(tabName + 'Content');
        if (activeContent) {
          activeContent.classList.remove('hidden');
        }
      };

      // Make buttons functional
      const editProfileBtns = document.querySelectorAll('#editProfileBtn, #dockEditProfileBtn');
      editProfileBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          alert('Edit Profile functionality would be implemented here');
        });
      });

      const changePasswordBtns = document.querySelectorAll('#changePasswordBtn, #dockChangePasswordBtn');
      changePasswordBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          alert('Change Password functionality would be implemented here');
        });
      });

      const logoutBtns = document.querySelectorAll('#logoutBtn, #dockLogoutBtn');
      logoutBtns.forEach(btn => {
        btn.addEventListener('click', async function() {
          if (confirm('Are you sure you want to sign out?')) {
            try {
              // Call logout API
              await window.api.auth.logout();
            } catch (error) {
              console.error('Logout error:', error);
            } finally {
              // Clear all session data and redirect
              localStorage.removeItem('user');
              localStorage.removeItem('currentUser');
              localStorage.removeItem('tokens');
              sessionStorage.clear();
              window.location.href = './login.html';
            }
          }
        });
      });
    });
  </script>
</body>
</html>


